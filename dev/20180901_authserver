20180901 - 認証・認可サーバを作る
=====

## 概要
Node.js + express.jsで認証・認可サーバを作る方法について調べる。
要件は以下。

* アプリからのAPIリクエストの認証・認可ができること
* 認証と同時にユーザー識別子を取得できること
* Google Accountなど外部サービスのOpenIDをパスワード認証の代わりに使用できること
* 初期はアプリ内に保存した自動生成のIDとパスワードで認証できること

興味はあるけど現時点ではいらなそうな機能は以下。

* 2段階認証
* Touch IDなどの生体認証をパスワード認証の代わりに使用

## 構成
パスワード認証をベースとしたOpen ID Connectでできる気がする。
3種類のユーザー認証が必要になりそう。

* アプリユーザー認証 (userid)
  * アプリを使うユーザ一人一人を識別するためのもっとも重要な認証
  * useridで識別
  * 基本はパスワード認証
  * 外部サービス連携した場合はそのサービスのOpenIDをパスワードの代わりに使用できる
  * 認証後に独自のOpen IDを発行して権限を引き回す
* アプリ認証 (appid)
  * 自分が発行したアプリであることを証明する認証と認可が一緒になったID
  * 管理者用画面でsecretと一緒に発行
  * これいつ認証するんだ...?
* 管理者認証 (adminid)
  * appidの発行などを行えるユーザーの認証
  * Google AccountのOpenIDで認証
  * IDはメールアドレスでよさそう
